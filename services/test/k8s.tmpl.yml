{{IMAGE_VERSION=latest}}
apiVersion: v1
kind: Pod
metadata:
  name: integration-tests
spec:
  containers:
  - image: riox/hyperriox:{{IMAGE_VERSION}}
    name: integration-tests
    command:
      [ "sh", "-c", "gulp test:integration && cat services/test/test-report.xml"]
    env:
      - name: RIOX_ENV
        valueFrom:
          fieldRef:
            fieldPath: metadata.namespace
      - name: TEST_REPORTER
        value: mocha-jenkins-reporter
  imagePullSecrets:
    - name: rioxregistrykey
  restartPolicy: Never
