<section ng-controller="SimsController">
	<div>

		<div style="margin-bottom: 10px;" class="text-right">
			<button class="btn btn-primary btn-sm" id="btnAddSim">
				<span class="glyphicon glyphicon-plus"></span> Add New Simulation
			</button>
			<button class="btn btn-warning btn-sm" id="btnDeleteSim">
				<span class="glyphicon glyphicon-minus"></span> Delete Simulation
			</button>
		</div>

		<!-- table view -->
		<div id="simTable" ui-grid="gridConfig" ui-grid-selection ui-grid-edit
			ui-grid-row-edit class="grid"></div>
	</div>
</section>
<style type="text/css">
#simTable {
	height: 200px;
}
</style>
<script type="text/javascript">

var app = angular.module("app");
app.controller('SimsController', function ($scope, $http, $compile, $routeParams, $log) {
	AppController($scope, $http, $compile);

	$scope.gridConfig = {};
	$scope.CREATION_DATE = CREATION_DATE;

	var initTable = function () {
		var columnsConfig = [
			{label: "Name", field: "name", sortable: true},
			{label: "Simulation Type", field: "simulation.type"},
			//{label: "Parameters", field: "simulation.parameters.length"}
		];
		$scope.gridConfig.data = [];
		renderUITable($scope.gridConfig, "simTable", columnsConfig,
			function (event) {
				if (event.type == "dgrid-select") {
					$scope.$apply(function () {
						$scope.shared.selectedSim = event.rows[0].data;
					});
				} else if (event.type == "dgrid-deselect") {
					$scope.$apply(function () {
						$scope.shared.selectedSim = null;
					});
				}
			}
		);
	};

	var loadTable = function() {
		riots.simulationTypes(function(sims){
			$scope.gridConfig.data = sims;
		});
	}

	var addSim = function () {
		var newItem = {name: "New Simulation"};
		riots.add.simulationType(newItem, function(newSim) {
			loadTable();
		});
	};
	var deleteSim = function () {
		riots.delete.simulationType($scope.shared.selectedSim, function() {
			$scope.shared.selectedSim = null;
			loadTable();
		});
	};

	/* add event listeners */
	$scope.addClickHandler("btnAddSim", addSim);
	$scope.addClickHandler("btnDeleteSim", deleteSim);

	/* render main elements */
	initTable();
	loadTable();

});

</script>
